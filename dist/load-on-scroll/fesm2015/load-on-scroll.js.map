{"version":3,"file":"load-on-scroll.js.map","sources":["ng://load-on-scroll/lib/load-on-scoll.directive.ts","ng://load-on-scroll/lib/load-on-scroll.module.ts"],"sourcesContent":["import { Directive, Input, Output, EventEmitter, ElementRef, Renderer2, HostListener } from '@angular/core';\nimport { Subject, Subscription, fromEvent } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\n@Directive({\n  selector: '[dmLoadOnScoll]'\n})\nexport class LoadOnScollDirective {\n  @Input()\n  first: number = 0;\n\n  @Input()\n  itemsPerPage: number;\n\n  @Input()\n  loadDoneSubject: Subject<any>;\n\n  @Input()\n  rotateOnLoadChildSelector: string;\n\n  @Input()\n  rotateOnLoad = false;\n\n  @Input()\n  disableOnLoad = false;\n\n  @Input()\n  bottomPixelBorder = 25;\n\n  @Output()\n  loadTrigger = new EventEmitter<any>();\n\n  private scrollSubscription: Subscription;\n\n  constructor(private el: ElementRef, private renderer: Renderer2) {}\n\n  ngOnInit() {\n    this.emitCurrentValues();\n  }\n\n  ngOnChanges() {\n    if (this.scrollSubscription) this.scrollSubscription.unsubscribe();\n\n    this.scrollSubscription = fromEvent(window, 'scroll')\n      .pipe(debounceTime(200))\n      .subscribe(e => {\n        if (window.scrollY + window.innerHeight + this.bottomPixelBorder >= document.body.scrollHeight) {\n          this.onClick();\n        }\n      });\n\n    if (this.loadDoneSubject) {\n      this.loadDoneSubject.subscribe(e => {\n        this.setOnLoad(false);\n      });\n    }\n  }\n\n  @HostListener('click')\n  onClick() {\n    this.setOnLoad(true);\n    this.first += this.itemsPerPage;\n    this.emitCurrentValues();\n  }\n\n  private emitCurrentValues() {\n    this.loadTrigger.emit({\n      limit: this.itemsPerPage,\n      first: this.first\n    });\n  }\n\n  private setOnLoad(load: boolean) {\n    if (this.disableOnLoad) this.disable(load);\n    if (this.rotateOnLoad) this.rotate(load);\n  }\n\n  private rotate(on: boolean) {\n    const componentToRotate = this.rotateOnLoadChildSelector\n      ? this.el.nativeElement.querySelector(this.rotateOnLoadChildSelector)\n      : this.el.nativeElement;\n\n    if (on) this.renderer.addClass(componentToRotate, 'los-rotate');\n    else this.renderer.removeClass(componentToRotate, 'los-rotate');\n  }\n\n  private disable(on: boolean) {\n    this.renderer.setProperty(this.el.nativeElement, 'disabled', on);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { LoadOnScollDirective } from './load-on-scoll.directive';\n\n@NgModule({\n  declarations: [LoadOnScollDirective],\n  imports: [],\n  exports: [LoadOnScollDirective]\n})\nexport class LoadOnScrollModule {}\n"],"names":[],"mappings":";;;;;;;;AAAA,MAOa,oBAAoB;;;;;IA2B/B,YAAoB,EAAc,EAAU,QAAmB;QAA3C,OAAE,GAAF,EAAE,CAAY;QAAU,aAAQ,GAAR,QAAQ,CAAW;QAzB/D,UAAK,GAAW,CAAC,CAAC;QAYlB,iBAAY,GAAG,KAAK,CAAC;QAGrB,kBAAa,GAAG,KAAK,CAAC;QAGtB,sBAAiB,GAAG,EAAE,CAAC;QAGvB,gBAAW,GAAG,IAAI,YAAY,EAAO,CAAC;KAI6B;;;;IAEnE,QAAQ;QACN,IAAI,CAAC,iBAAiB,EAAE,CAAC;KAC1B;;;;IAED,WAAW;QACT,IAAI,IAAI,CAAC,kBAAkB;YAAE,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;QAEnE,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC;aAClD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;aACvB,SAAS;;;;QAAC,CAAC;YACV,IAAI,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,WAAW,GAAG,IAAI,CAAC,iBAAiB,IAAI,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE;gBAC9F,IAAI,CAAC,OAAO,EAAE,CAAC;aAChB;SACF,EAAC,CAAC;QAEL,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,eAAe,CAAC,SAAS;;;;YAAC,CAAC;gBAC9B,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;aACvB,EAAC,CAAC;SACJ;KACF;;;;IAGD,OAAO;QACL,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACrB,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,YAAY,CAAC;QAChC,IAAI,CAAC,iBAAiB,EAAE,CAAC;KAC1B;;;;;IAEO,iBAAiB;QACvB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;YACpB,KAAK,EAAE,IAAI,CAAC,YAAY;YACxB,KAAK,EAAE,IAAI,CAAC,KAAK;SAClB,CAAC,CAAC;KACJ;;;;;;IAEO,SAAS,CAAC,IAAa;QAC7B,IAAI,IAAI,CAAC,aAAa;YAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC3C,IAAI,IAAI,CAAC,YAAY;YAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KAC1C;;;;;;IAEO,MAAM,CAAC,EAAW;;cAClB,iBAAiB,GAAG,IAAI,CAAC,yBAAyB;cACpD,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,aAAa,CAAC,IAAI,CAAC,yBAAyB,CAAC;cACnE,IAAI,CAAC,EAAE,CAAC,aAAa;QAEzB,IAAI,EAAE;YAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,iBAAiB,EAAE,YAAY,CAAC,CAAC;;YAC3D,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,iBAAiB,EAAE,YAAY,CAAC,CAAC;KACjE;;;;;;IAEO,OAAO,CAAC,EAAW;QACzB,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,UAAU,EAAE,EAAE,CAAC,CAAC;KAClE;;;YApFF,SAAS,SAAC;gBACT,QAAQ,EAAE,iBAAiB;aAC5B;;;;YANgD,UAAU;YAAE,SAAS;;;oBAQnE,KAAK;2BAGL,KAAK;8BAGL,KAAK;wCAGL,KAAK;2BAGL,KAAK;4BAGL,KAAK;gCAGL,KAAK;0BAGL,MAAM;sBA6BN,YAAY,SAAC,OAAO;;;;;;;AC1DvB,MAQa,kBAAkB;;;YAL9B,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,oBAAoB,CAAC;gBACpC,OAAO,EAAE,EAAE;gBACX,OAAO,EAAE,CAAC,oBAAoB,CAAC;aAChC;;;;;;;;;;;;;;;"}
